C51 COMPILER V9.60.7.0   MAIN                                                              02/02/2026 19:21:10 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main\main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\include) DEBUG OBJECTEXTEN
                    -D PRINT(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "main.h"
   2          
   3          enum {
   4            SONIC_TIME = 1000,
   5            KEY_TIME = 20,
   6          };
   7          
   8          sonic_t sonic;
   9          key_t key;
  10          
  11          void key_task() {
  12   1        if (key.press == 4) {
  13   2          if (sonic.mode == 1) {
  14   3            sonic.mode = 2;
  15   3            set_seg(7, 2);
  16   3          } else if (sonic.mode == 2) {
  17   3            sonic.mode = 1;
  18   3            set_seg(7, 1);
  19   3          }
  20   2        }
  21   1      }
  22          
  23          void sonic_task() {
  24   1        if (sonic.mode == 1) {
  25   2          sonic.distance = sonic_measure_mode1();
  26   2        } else if (sonic.mode == 2) {
  27   2          sonic.distance = sonic_measure_mode2();
  28   2        }
  29   1      
  30   1        set_seg(0, sonic.distance / 100 % 10);
  31   1        set_seg(1, sonic.distance / 10 % 10);
  32   1        set_seg(2, sonic.distance % 10);
  33   1      
  34   1        set_seg(3, 17);
  35   1        set_seg(4, 17);
  36   1        set_seg(5, 17);
  37   1        set_seg(6, 17);
  38   1      }
  39          void main() {
  40   1        boot_init();
  41   1        sonic.mode = 1;
  42   1        set_seg(7, 1);
  43   1        while (1) {
  44   2      
  45   2          if (sonic.time == SONIC_TIME) {
  46   3            sonic.time = 0;
  47   3            sonic_task();
  48   3          }
  49   2      
  50   2          if (key.time == KEY_TIME) {
  51   3            key.time = 0;
  52   3            key.press = key_scan();
  53   3            key_task();
  54   3          }
C51 COMPILER V9.60.7.0   MAIN                                                              02/02/2026 19:21:10 PAGE 2   

  55   2        }
  56   1      }
  57          
  58          void Timer2_Isr(void) interrupt 12 {
  59   1        seg_display();
  60   1      
  61   1        if (sonic.time < SONIC_TIME) {
  62   2          sonic.time++;
  63   2        }
  64   1      
  65   1        if (key.time < KEY_TIME) {
  66   2          key.time++;
  67   2        }
  68   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    258    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
