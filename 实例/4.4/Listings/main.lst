C51 COMPILER V9.60.7.0   MAIN                                                              04/07/2025 15:38:42 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Program Files\keil5\C51\BIN\C51.EXE code\main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRIN
                    -T(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "main.h"
   2          
   3          
   4          enum {
   5              TASK_DS1302 = 100,
   6              TASK_STATE = 25
   7          };
   8          
   9          
  10          extern uchar led[8];
  11          extern uchar seg[8];
  12          
  13          
  14          // ds1302   -> date
  15          struct {
  16              uchar now_time[3];
  17              uchar time;
  18              uchar init_time[3];
  19          } date = {
  20              { 0, 0, 0 },
  21              0,
  22              { 23,59,50 }
  23          };
  24          
  25          
  26          // 数码管显示数据 -> state
  27          struct {
  28              uint time;
  29              uchar mode1;
  30              uchar only;
  31          } state;
  32          
  33          // 数据界面 -> ADC数据
  34          struct {
  35              uint light_value;
  36              uint RB2_value;
  37          } adc;
  38          
  39          
  40          // 查询界面 -> 数组
  41          struct {
  42              uchar value[3][3];
  43              uchar index;
  44          } search;
  45          
  46          
  47          void main()
  48          {
  49   1          boot_init(); 
  50   1          state.only = 255;
  51   1          write_datetime();
*** WARNING C206 IN LINE 51 OF code\main.c: 'write_datetime': missing function-prototype
  52   1          while (1)
  53   1          {
C51 COMPILER V9.60.7.0   MAIN                                                              04/07/2025 15:38:42 PAGE 2   

  54   2              if (date.time == TASK_DS1302)
  55   2              {
  56   3                  date.time = 0;
  57   3                  ds1302_proc();
  58   3              }
  59   2      
  60   2              if (state.time == TASK_STATE)
  61   2              {
  62   3                  state.time = 0;
  63   3                  state_proc();
  64   3              }
  65   2          }
  66   1      }
  67          
  68          void Timer1_Isr(void) interrupt 3
  69          {
  70   1          seg_display();
*** WARNING C206 IN LINE 70 OF code\main.c: 'seg_display': missing function-prototype
  71   1          led_display();
*** WARNING C206 IN LINE 71 OF code\main.c: 'led_display': missing function-prototype
  72   1      
  73   1          if (date.time < TASK_DS1302) { date.time++; }
  74   1      
  75   1          if (state.time < TASK_STATE) { state.time++; }
  76   1      
  77   1      
  78   1      }
  79          
  80          
  81          
  82          void ds1302_proc()
  83          {
  84   1          read_datatime(date.now_time);
*** WARNING C206 IN LINE 84 OF code\main.c: 'read_datatime': missing function-prototype
*** ERROR C267 IN LINE 84 OF code\main.c: 'read_datatime': requires ANSI-style prototype
  85   1      }
  86          
  87          void state_proc()
  88          {
  89   1          switch ()
*** ERROR C141 IN LINE 89 OF code\main.c: syntax error near ')', expected 'sizeof'
  90   1          {
  91   2              case 0: 
  92   2              {
  93   3                  // 时间界面
  94   3                  if (state.only != 0)
  95   3                  {
  96   4                      state.only == 0;
  97   4                      seg[2] = 17; seg[5] = 17; 
  98   4                  }
  99   3                  // 小时
 100   3                  seg[0] = date.now_time[2] / 10 % 10;
 101   3                  seg[1] = date.now_time[2] % 10;
 102   3                  // 分钟
 103   3                  seg[3] = date.now_time[1] / 10 % 10;
 104   3                  seg[4] = date.now_time[1] % 10;
 105   3                  // 秒
 106   3                  seg[6] = date.now_time[0] / 10 % 10;
 107   3                  seg[7] = date.now_time[0] % 10;
 108   3              }
 109   2              break;
 110   2      
C51 COMPILER V9.60.7.0   MAIN                                                              04/07/2025 15:38:42 PAGE 3   

 111   2              // 数据界面 P g. g g  U v. v v     g -> 光敏电阻   v -> 旋钮电压 
 112   2              case 1:
 113   2              {
 114   3                  if (state.only != 2)
 115   3                  {
 116   4                      state.only = 2;
 117   4                      seg[0] = 24; seg[4] = 25;
 118   4                  }
 119   3      
 120   3                  seg[1] = ADC.light_value / 100 % 10;
 121   3                  seg[2] = (ADC.light_value / 10 % 10) + 32;
 122   3                  seg[3] = ADC.light_value % 10;
 123   3                  
 124   3                  seg[5] = ADC.RB2_value / 100 % 10;
 125   3                  seg[6] = (ADC.RB2_value / 10 % 10) + 32;
 126   3                  seg[7] = ADC.RB2_value % 10;
 127   3              }
 128   2              break;
 129   2      
 130   2              case 2:
 131   2              {
 132   3                  if (state.only != 2)
 133   3                  {
 134   4                      state.only = 2;
 135   4                      seg[0] = 42;
 136   4                  }
 137   3                  seg[1] = state.index;
*** ERROR C204 IN LINE 137 OF code\main.c: 'index': undefined member
 138   3                  seg[2] = state.
 139   3              }
*** ERROR C141 IN LINE 139 OF code\main.c: syntax error near '}', expected '<id>'
 140   2              break;
 141   2              
 142   2          }
 143   1      }
 144          
 145          void ADC_proc()
 146          {
 147   1          adc.light_value = ( ADC(0x01) / 255)* 500;
 148   1          adc.RB2_value = ( ADC(0x03) / 255)* 500;
 149   1      }
 150          
 151          
 152          void search_proc()
 153          {
 154   1      
 155   1      }

C51 COMPILATION COMPLETE.  4 WARNING(S),  4 ERROR(S)
