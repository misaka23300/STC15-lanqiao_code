C51 COMPILER V9.60.7.0   BOOT                                                              12/10/2025 17:56:40 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE BOOT
OBJECT MODULE PLACED IN .\Objects\boot.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main\boot.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\include) DEBUG OBJECTEXTEN
                    -D PRINT(.\Listings\boot.lst) TABS(2) OBJECT(.\Objects\boot.obj)

line level    source

   1          /**
   2           * @file boot.c
   3           * @brief å¼•å¯¼ä¸Žå®šæ—¶å™¨åˆå§‹åŒ–æ¨¡å—
   4           * @details åˆå§‹åŒ–ç«¯å£æ¨¡å¼ã€é”å­˜çº¿(latch)å’Œå®šæ—¶å™¨1ï¼Œä»¥åŠæä¾›çŸ­å»¶æ—¶å‡½æ•°ã€‚
   5           * @author
   6           * @date 2025-12-09
   7           */
   8          
   9          #include "boot.h"
  10          
  11          /**
  12           * @brief åˆå§‹åŒ–ç¡¬ä»¶å¼•è„šæ¨¡å¼å¹¶å¯åŠ¨å®šæ—¶å™¨1
  13           *
  14           * è¯¥å‡½æ•°è®¾ç½®æ‰€æœ‰ç«¯å£çš„æ¨¡å¼å¯„å­˜å™¨ä¸ºå‡†åŒå‘å£ï¼ˆæˆ–é»˜è®¤å€¼ï¼‰ï¼Œ
  15           * å¯¹ P0 è¾“å‡ºç‰¹å®šåºåˆ—å¹¶é€šè¿‡ latch æŽ§åˆ¶é”å­˜çº¿ï¼ŒéšåŽåˆå§‹åŒ–å®šæ—¶å™¨1å¹¶ä½¿èƒ½å…¨å±€ä¸­æ
             -–­ã€‚
  16           *
  17           * @note è°ƒç”¨æ­¤å‡½æ•°åŽï¼Œå®šæ—¶å™¨1ä¸­æ–­è¢«ä½¿èƒ½ï¼ˆET1 = 1ï¼‰ï¼Œå…¨å±€ä¸­æ–­ä½¿èƒ½ï¼ˆEA = 1ï¼‰ã€‚
  18           */
  19          void boot_init()
  20          {
  21   1          P0M0 = 0x00;
  22   1          P0M1 = 0x00;
  23   1          P1M0 = 0x00;
  24   1          P1M1 = 0x00;
  25   1          P2M0 = 0x00;
  26   1          P2M1 = 0x00;
  27   1          P3M0 = 0x00;
  28   1          P3M1 = 0x00;
  29   1          P4M0 = 0x00;
  30   1          P4M1 = 0x00;
  31   1          P5M0 = 0x00;
  32   1          P5M1 = 0x00;
  33   1          P6M0 = 0x00;
  34   1          P6M1 = 0x00;
  35   1          P7M0 = 0x00;
  36   1          P7M1 = 0x00;
  37   1      
  38   1          P0 = 0xFF;
  39   1          latch(4);
  40   1      
  41   1          P0 = 0xAF;
  42   1          latch(5);
  43   1      
  44   1          P0 = 0x00;
  45   1          latch(6);
  46   1      
  47   1          P0 = 0xFF;
  48   1          latch(7);
  49   1      
  50   1          latch(0);
  51   1      
  52   1          Timer1_Init();
  53   1          EA = 1;
C51 COMPILER V9.60.7.0   BOOT                                                              12/10/2025 17:56:40 PAGE 2   

  54   1      }
  55          
  56          /**
  57           * @brief è®¾ç½® P2 ç«¯å£ä»¥é€‰æ‹©ä¸åŒçš„ latch çŠ¶æ€
  58           *
  59           * æ ¹æ®å‚æ•° i ä¿®æ”¹ P2 çš„é«˜ä¸‰ä½ä»¥æŽ§åˆ¶ä¸åŒçš„é”å­˜è®¾å¤‡/é€šè·¯ï¼š
  60           * - 4 => è®¾ç½®ä¸º 0x80
  61           * - 5 => è®¾ç½®ä¸º 0xA0
  62           * - 6 => è®¾ç½®ä¸º 0xC0
  63           * - 7 => è®¾ç½®ä¸º 0xE0
  64           * - 0 => æ¸…é™¤é«˜ä¸‰ä½ï¼ˆæ¢å¤ 0ï¼‰
  65           *
  66           * @param i latch ç´¢å¼•ï¼ˆ0,4,5,6,7ï¼‰
  67           */
  68          void latch(uint8_t i)
  69          {
  70   1          switch (i) {
  71   2              case 4: {
  72   3                  P2 = (P2 & 0x1F) | 0x80;
  73   3                  break;
  74   3              }
  75   2              case 5: {
  76   3                  P2 = (P2 & 0x1F) | 0xA0;
  77   3                  break;
  78   3              }
  79   2              case 6: {
  80   3                  P2 = (P2 & 0x1F) | 0xC0;
  81   3                  break;
  82   3              }
  83   2              case 7: {
  84   3                  P2 = (P2 & 0x1F) | 0xE0;
  85   3                  break;
  86   3              }
  87   2              case 0: {
  88   3                  P2 = P2 & 0x1F;
  89   3                  break;
  90   3              }
  91   2          }
  92   1      }
  93          
  94          /**
  95           * @brief åˆå§‹åŒ–å®šæ—¶å™¨1ä»¥äº§ç”Ÿçº¦1æ¯«ç§’ä¸­æ–­ï¼ˆåŸºäºŽ12.000MHzæ™¶æŒ¯ï¼‰
  96           *
  97           * @note é…ç½®ä¸º12Tæ¨¡å¼ï¼Œè®¾ç½®åˆå€¼å¹¶ä½¿èƒ½å®šæ—¶å™¨ä¸­æ–­ã€‚
  98           */
  99          void Timer1_Init(void) // 1æ¯«ç§’@12.000MHz
 100          {
 101   1          AUXR &= 0xBF; // å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼
 102   1          TMOD &= 0x0F; // è®¾ç½®å®šæ—¶å™¨æ¨¡å¼
 103   1          TL1 = 0x18;   // è®¾ç½®å®šæ—¶åˆå§‹å€¼
 104   1          TH1 = 0xFC;   // è®¾ç½®å®šæ—¶åˆå§‹å€¼
 105   1          TF1 = 0;      // æ¸…é™¤TF1æ ‡å¿—
 106   1          TR1 = 1;      // å®šæ—¶å™¨1å¼€å§‹è®¡æ—¶
 107   1          ET1 = 1;      // ä½¿èƒ½å®šæ—¶å™¨1ä¸­æ–­
 108   1      }
 109          
 110          /**
 111           * @brief çº¦14å¾®ç§’å»¶æ—¶ï¼ˆåŸºäºŽ12.000MHzï¼‰
 112           *
 113           * @note ä¾èµ–ç¼–è¯‘å™¨çš„ç©ºæ“ä½œæŒ‡ä»¤ä¸Žå¾ªçŽ¯æ¶ˆè€—æ¥å®žçŽ°çŸ­å»¶æ—¶ã€‚
 114           */
 115          void Delay14us(void) //@12.000MHz
C51 COMPILER V9.60.7.0   BOOT                                                              12/10/2025 17:56:40 PAGE 3   

 116          {
 117   1          unsigned char data i;
 118   1      
 119   1          _nop_();
 120   1          _nop_();
 121   1          i = 39;
 122   1          while (--i);
 123   1      }
 124          
 125          /*
 126           * ä»¥ä¸‹ä¸ºå¤‡ç”¨/æ³¨é‡ŠæŽ‰çš„å®šæ—¶å™¨é…ç½®å‡½æ•°ï¼Œä¿ç•™åŽŸæ³¨é‡Šå¹¶æ·»åŠ æ–‡æ¡£è¯´æ˜Žä»¥ä¾¿æœªæ¥ä½¿
             -ç”¨æˆ–æ–‡æ¡£ç”Ÿæˆã€‚
 127           *
 128           * @brief æ³¨é‡ŠæŽ‰çš„å‡½æ•°ï¼štimer_0_sonic - ç”¨äºŽå®šæ—¶å™¨0çš„å£°çº³è®¡æ—¶ï¼ˆç¤ºä¾‹ï¼‰
 129           * @brief æ³¨é‡ŠæŽ‰çš„å‡½æ•°ï¼štimer_0_ne555 - ç”¨äºŽ NE555 å¤–éƒ¨è„‰å†²å¤„ç†ï¼ˆç¤ºä¾‹ï¼‰
 130           */
 131          /* void timer_0_sonic()
 132          {
 133              AUXR &= 0x7F;     //å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼
 134              TMOD &= 0xF0;     //è®¾ç½®å®šæ—¶å™¨æ¨¡å¼
 135              TL0 = 0x00;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
 136              TH0 = 0x00;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
 137              TF0 = 0;        //æ¸…é™¤TF0æ ‡å¿—
 138              TR0 = 0;        //å®šæ—¶å™¨0å¼€å§‹è®¡æ—¶
 139              ET0 = 0;        //ä½¿èƒ½å®šæ—¶å™¨0ä¸­æ–­
 140          }
 141          
 142          void timer_0_ne555()
 143          {
 144              //TMOD -> 0000 0110
 145              // AUXR -> 0xxx xxxx
 146              TMOD = (TMOD & 0xF0) | 0x06;
 147              TL0 = 0xFF;
 148              TH0 = 0xFF;
 149              ET0 = 1;
 150          }
 151           */


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    159    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
